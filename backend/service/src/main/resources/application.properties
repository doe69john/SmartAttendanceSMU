spring.config.import=optional:file:../../.env.local[.properties],optional:file:../.env.local[.properties],optional:file:.env.local[.properties]
spring.application.name=attendance

attendance.data-dir=${DATA_DIR:backend/runtime/data}
attendance.session.time-zone=${ATTENDANCE_TIME_ZONE:Asia/Singapore}

spring.datasource.url=${SUPABASE_JDBC_URL:jdbc:postgresql://localhost:5432/postgres}
spring.datasource.username=${SUPABASE_DB_USER:postgres}
spring.datasource.password=${SUPABASE_DB_PASSWORD:}
spring.datasource.driver-class-name=${SUPABASE_DB_DRIVER:org.postgresql.Driver}
spring.datasource.hikari.maximum-pool-size=${DB_POOL_MAX:5}
spring.datasource.hikari.minimum-idle=${DB_POOL_MIN:2}
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.pool-name=AttendanceHikariCP
spring.datasource.hikari.auto-commit=true

spring.jpa.hibernate.ddl-auto=none
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.default_schema=${SUPABASE_DB_SCHEMA:public}
spring.jpa.database-platform=${SUPABASE_JPA_DIALECT:org.hibernate.dialect.PostgreSQLDialect}

spring.session.store-type=none
spring.session.jdbc.initialize-schema=always
server.servlet.session.timeout=30m
server.port=${SERVER_PORT:18080}

springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operations-sorter=method
springdoc.swagger-ui.tags-sorter=alpha

app.security.password-encoder=strength-12
app.security.professor-passcode-hash=${PROFESSOR_PASSCODE_HASH:}
app.security.professor-passcode=${PROFESSOR_PASSCODE:}
app.security.admin-passcode-hash=${ADMIN_PASSCODE_HASH:}
app.security.admin-passcode=${ADMIN_PASSCODE:}
app.security.enable-cookie-authorization=${APP_ENABLE_COOKIE_AUTHORIZATION:false}

logging.level.org.springframework.security=INFO
supabase.project-url=${SUPABASE_URL:https://thczhszfvqdyurrvxjvm.supabase.co}
supabase.auth.jwks-uri=${SUPABASE_JWKS_URI:${supabase.project-url}/auth/v1/.well-known/jwks.json}
supabase.auth.issuer=${SUPABASE_JWT_ISSUER:${supabase.project-url}/auth/v1}
supabase.auth.audience=${SUPABASE_JWT_AUDIENCE:authenticated}
supabase.auth.jwt-secret=${SUPABASE_JWT_SECRET:}
supabase.gotrue.base-url=${SUPABASE_GOTRUE_URL:${supabase.project-url}/auth/v1}
supabase.gotrue.anon-key=${SUPABASE_ANON_KEY:}
supabase.gotrue.cookie-secure=${SUPABASE_COOKIE_SECURE:false}
supabase.gotrue.cookie-same-site=${SUPABASE_COOKIE_SAME_SITE:Lax}
supabase.gotrue.cookie-path=${SUPABASE_COOKIE_PATH:/}
supabase.gotrue.refresh-token-ttl-days=${SUPABASE_REFRESH_TTL_DAYS:30}
supabase.gotrue.reset-redirect-url=${SUPABASE_RESET_REDIRECT_URL:}
supabase.storage.face-image-bucket=${SUPABASE_FACE_BUCKET:face-images}
supabase.storage.public-base-url=${SUPABASE_STORAGE_PUBLIC_URL:}
supabase.storage.service-access-token=${SUPABASE_STORAGE_SERVICE_JWT:${SUPABASE_STORAGE_SERVICE_ACCESS_TOKEN:${SUPABASE_SERVICE_ROLE_KEY:}}}

companion.release.auto-publish=${COMPANION_AUTO_PUBLISH:false}
companion.release.notes=${COMPANION_RELEASE_NOTES:Automated companion build}


# Tomcat thread caps
server.tomcat.threads.max=32
server.tomcat.accept-count=50

# start lighter
spring.main.lazy-initialization=true
